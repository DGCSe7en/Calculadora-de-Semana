<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora de tiempo</title>
  <style>
    body {
      transition: background-color 0.3s, color 0.3s;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      padding: 55px;
    }
    body.modo-oscuro {
      background-color: #2e2e2e;
      color: #e0e0e0;
    }
    body.modo-claro {
      background-color: #f0f0f0;
      color: #1a1a1a;
    }
    .modo-claro .texto-azul { color: #000B62; }
    .modo-oscuro .texto-azul { color: #90D5FF; }
    .modo-claro .reloj { color: #041037; }
    .modo-oscuro .reloj { color: #90D5FF; }
    .reloj { font-size: 32px; font-weight: bold; }
    .resultado, .zona { margin-top: 20px; font-size: 16px; }
    input, button {
      padding: 10px;
      margin: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover { background-color: #2980b9; }
    #modo-toggle {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 20px;
      color: inherit;
    }
    .calendar-container {
      max-width: 90%;
      margin: 20px auto;
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .calendar-container iframe {
      width: 100%;
      height: 400px;
      border: none;
    }
    @media (max-width: 400px) {
      .calendar-container iframe { height: 400px; }
    }
  </style>
</head>
<body>
  <h1><span class="texto-azul">Calculadora de tiempo</span></h1>
  <div class="reloj" id="reloj"></div>
  <div class="zona" id="zonaHoraria"></div>
  <p id="semanaActual"></p>

  <div>
    <h3><span class="texto-azul">Introduce una fecha</span></h3>
  <input type="date" id="fecha">
  <button onclick="calcularSemana()">Calcular semana</button>
  <button onclick="resetearFormulario()">Resetear</button>
  <div class="resultado" id="resultado">
  </div>

  <div>
    <h3><span class="texto-azul">Número de días entre dos fechas</span></h3>
    <input type="date" id="fechaInicio"> a
    <input type="date" id="fechaFin">
    <button onclick="calcularDias()">Calcular días</button>
    <button onclick="resetDias()">Resetear</button>
    <p id="resultadoDias"></p>
  </div>

  <div>
    <h3><span class="texto-azul">Rango de fechas de una semana</span></h3>
    <label for="semanaInput">Semana del año:</label>
    <input type="number" id="semanaInput" min="1" max="53">
    <button onclick="calcularRangoSemana()">Mostrar rango</button>
    <button onclick="resetSemana()">Resetear</button>
    <p id="resultadoSemana"></p>
  </div>

  <!-- Calendario -->
  <div class="calendar-container">
    <iframe src="https://calendar.google.com/calendar/embed?src=es.spain%23holiday%40group.v.calendar.google.com&ctz=Europe%2FMadrid&showTitle=0&showTz=0"></iframe>
  </div>

<!-- Firma / footer -->
<footer class="firma">
  <p>El sitio podría cometer errores, considera contrastar la información.</p>
  <p>Calculadora de tiempo V3.0 por DGCSe7en - Github</p>
</footer>

<style>
  .firma {
    margin-top: 15px;
    font-size: 11px;
    text-align: center;
    opacity: 0.7;
  }
  body.modo-claro .firma { color: #666; }
  body.modo-oscuro .firma { color: #aaa; }
</style>


  <button id="modo-toggle" onclick="toggleModo()">☀︎/☾</button>

  <script>
    let fechaCalendario = new Date();

    function formatoFecha(fecha) {
      const dia = String(fecha.getDate()).padStart(2, '0');
      const mes = String(fecha.getMonth() + 1).padStart(2, '0');
      const año = fecha.getFullYear();
      return `${dia}/${mes}/${año}`;
    }

    function calcularSemana() {
      const fechaInput = document.getElementById("fecha").value;
      if (!fechaInput) { alert("Por favor, introduce una fecha válida."); return; }
      const fecha = new Date(fechaInput);
      const primeraFecha = new Date(fecha.getFullYear(), 0, 1);
      const dias = Math.floor((fecha - primeraFecha) / (24 * 60 * 60 * 1000));
      const semana = Math.ceil((dias + (primeraFecha.getDay() + 6) % 7 + 1) / 7);
      document.getElementById("resultado").innerText = `La fecha ${formatoFecha(fecha)} corresponde a la semana número ${semana} del año.`;
    }

    function resetearFormulario() {
      document.getElementById("fecha").value = "";
      const hoy = new Date();
      const primeraFecha = new Date(hoy.getFullYear(), 0, 1);
      const dias = Math.floor((hoy - primeraFecha) / (24 * 60 * 60 * 1000));
      const semanaActual = Math.ceil((dias + (primeraFecha.getDay() + 6) % 7 + 1) / 7);
      document.getElementById("semanaActual").innerText = `Hoy es ${formatoFecha(hoy)} y estamos en la semana número ${semanaActual} del año.`;
      document.getElementById("resultado").innerText = "";
      fechaCalendario = new Date();
    }

    function actualizarReloj() {
      const ahora = new Date();
      const opciones = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false, timeZone: 'Europe/Madrid' };
      const horaLocal = ahora.toLocaleTimeString('es-ES', opciones);
      document.getElementById("reloj").innerText = `Hora actual: ${horaLocal}`;
      const esVerano = ahora.getTimezoneOffset() === -120;
      document.getElementById("zonaHoraria").innerText = esVerano ? "Hora local de España (GMT+2)" : "Hora local de España (GMT+1)";
    }
    setInterval(actualizarReloj, 1000);
    resetearFormulario();

    function toggleModo() {
      const body = document.body;
      if (body.classList.contains('modo-oscuro')) {
        body.classList.remove('modo-oscuro');
        body.classList.add('modo-claro');
        localStorage.setItem('modo', 'claro');
      } else {
        body.classList.remove('modo-claro');
        body.classList.add('modo-oscuro');
        localStorage.setItem('modo', 'oscuro');
      }
    }
    window.onload = function() {
      const modoGuardado = localStorage.getItem('modo');
      if (modoGuardado === 'oscuro') document.body.classList.add('modo-oscuro');
      else document.body.classList.add('modo-claro');
    };

    // Funciones nuevas
    function calcularDias() {
      const inicio = new Date(document.getElementById("fechaInicio").value);
      const fin = new Date(document.getElementById("fechaFin").value);
      if (!isNaN(inicio) && !isNaN(fin)) {
        const dias = Math.abs((fin - inicio) / (1000 * 60 * 60 * 24));
        document.getElementById("resultadoDias").textContent = `Hay ${dias} días entre las fechas.`;
      }
    }

    function calcularRangoSemana() {
      const semana = parseInt(document.getElementById("semanaInput").value);
      const año = new Date().getFullYear();
      if (semana >= 1 && semana <= 53) {
        const primerDia = new Date(año, 0, 1);
        const diasOffset = (primerDia.getDay() <= 4 ? 0 : 7) - primerDia.getDay();
        const inicioSemana = new Date(año, 0, 1 + diasOffset + (semana - 1) * 7);
        const finSemana = new Date(inicioSemana);
        finSemana.setDate(inicioSemana.getDate() + 6);
        document.getElementById("resultadoSemana").textContent = `Semana ${semana}: del ${inicioSemana.toLocaleDateString()} al ${finSemana.toLocaleDateString()}`;
      }
    }


    function resetDias() {
      document.getElementById("fechaInicio").value = "";
      document.getElementById("fechaFin").value = "";
      document.getElementById("resultadoDias").textContent = "";
    }

    function resetSemana() {
      document.getElementById("semanaInput").value = "";
      document.getElementById("resultadoSemana").textContent = "";
    }

  </script>
</body>
</html>
