<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de tiempo V4.0</title>
<link rel="icon" type="image/png" href="favicon.png">
<style>
body { font-family: 'Segoe UI', sans-serif; text-align: center; padding: 20px; margin: 0; transition: background-color 0.3s, color 0.3s;}
body.modo-oscuro { background-color: #2e2e2e; color: #e0e0e0;}
body.modo-claro { background-color: #f0f0f0; color: #1a1a1a;}
.texto-azul { color: inherit; }
.modo-claro .texto-azul { color: #0D47A1; }
.modo-oscuro .texto-azul { color: #90D5FF; }

h1, h3 { margin: 10px 0; }
.reloj { font-size: 2em; font-weight: bold; }
.resultado, .zona { margin-top: 15px; font-size: 1em; color: #333; }
body.modo-oscuro .resultado, body.modo-oscuro .zona { color: #ddd; }

input, button { padding: 10px; margin: 5px; font-size: 1em; border-radius: 5px; border: 1px solid #ccc; width: 90%; max-width: 300px; box-sizing: border-box;}
button { background-color: #3498db; color: white; border: none; cursor: pointer; transition: background-color 0.2s;}
button:hover { background-color: #2980b9; }

#modo-toggle { position: fixed; bottom: 80px; right: 10px; font-size: 1.5em; background: none; border: none; cursor: pointer; color: inherit; z-index: 100; }

.seccion { margin: 20px auto; padding: 15px; border-radius: 8px; max-width: 600px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); background-color: rgba(255,255,255,0.9);}
body.modo-oscuro .seccion { background-color: rgba(50,50,50,0.9); }

.calendar-container { max-width: 90%; margin: 20px auto; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);}
.calendar-container iframe { width: 100%; height: 300px; border: none; }

.firma { margin-top: 15px; font-size: 0.8em; text-align: center; opacity: 0.7; }
body.modo-claro .firma { color: #666; }
body.modo-oscuro .firma { color: #aaa; }

/* Mensajes de error visuales */
.error { color: orange; font-weight: bold; font-style: italic; font-size: 0.9em; margin-top: 5px; opacity: 0; transition: opacity 0.4s; display: flex; align-items: center; justify-content: center; }
.error.visible { opacity: 1; }
.icono { margin-right: 5px; }
.input-error { border: 2px solid orange; animation: parpadeo 0.6s ease-in-out 2; }
@keyframes parpadeo { 0%,100%{ border-color: transparent;} 50%{ border-color: orange; } }

/* Banderas de idioma */
#idiomas { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
#idiomas img { width: 40px; height: 26px; cursor: pointer; border-radius: 4px; transition: transform 0.2s; }
#idiomas img:hover { transform: scale(1.1); }

@media(max-width:480px) { .reloj { font-size: 1.5em;} input, button { width: 95%; } .calendar-container iframe { height: 250px; } }
@media(min-width:481px) and (max-width:768px) { input, button { max-width: 90%; } .calendar-container iframe { height: 300px; } }
</style>
</head>
<body>

<h1 class="texto-azul" id="titulo"></h1>

<div id="idiomas">
  <img src="ESP.png" alt="Español" data-lang="es" onclick="cambiarIdioma(this.dataset.lang)">
  <img src="CAT.png" alt="Català" data-lang="ca" onclick="cambiarIdioma(this.dataset.lang)">
  <img src="GAL.png" alt="Galego" data-lang="gl" onclick="cambiarIdioma(this.dataset.lang)">
  <img src="EUS.png" alt="Euskera" data-lang="eu" onclick="cambiarIdioma(this.dataset.lang)">
</div>

<div class="reloj texto-azul" id="reloj"></div>
<div class="zona texto-azul" id="zonaHoraria"></div>
<p class="texto-azul" id="semanaActual"></p>

<div class="seccion">
  <h3 class="texto-azul" id="h3Semana"></h3>
  <input type="date" id="fecha">
  <button id="btnCalcularSemana" onclick="calcularSemana()"></button>
  <button id="btnResetSemana" onclick="resetearFormulario()"></button>
  <div class="resultado" id="resultado"></div>
  <p class="error" id="errorSemana"><span class="icono">⚠️</span></p>
</div>

<div class="seccion">
  <h3 class="texto-azul" id="h3Dias"></h3>
  <input type="date" id="fechaInicio" placeholder="">
  a
  <input type="date" id="fechaFin" placeholder="">
  <button id="btnCalcularDias" onclick="calcularDias()"></button>
  <button id="btnResetDias" onclick="resetDias()"></button>
  <p class="resultado" id="resultadoDias"></p>
  <p class="error" id="errorDias"><span class="icono">⚠️</span></p>
</div>

<div class="seccion">
  <h3 class="texto-azul" id="h3Rango"></h3>
  <label class="texto-azul" id="labelSemana" for="semanaInput"></label>
  <input type="number" id="semanaInput" min="1" max="53" placeholder="">
  <button id="btnMostrarRango" onclick="calcularRangoSemana()"></button>
  <button id="btnResetRango" onclick="resetSemana()"></button>
  <p class="resultado" id="resultadoSemana"></p>
  <p class="error" id="errorRangoSemana"><span class="icono">⚠️</span></p>
</div>

<div class="calendar-container">
  <iframe src="https://calendar.google.com/calendar/embed?src=es.spain%23holiday%40group.v.calendar.google.com&ctz=Europe%2FMadrid&showTitle=0&showTz=0"></iframe>
</div>

<button id="modo-toggle" onclick="toggleModo()">☀︎/☾</button>

<footer class="firma" id="footerFirma"></footer>

<script>
// Traducciones y resto del script, igual que en V3.7, adaptado para V4.0 y con colores azul en textos
// Mantener funciones toggleModo, cambiarIdioma, calcularSemana, calcularDias, calcularRangoSemana, resetear formularios, mostrar errores y actualizar reloj
// ...
</script>
</body>
</html>
